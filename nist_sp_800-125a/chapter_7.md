# 第 7 章 HY-BF5 安全性建议

对于任何服务器级别的软件而言，管理功能的安全选项都是至关重要的，虚拟机监视器也不例外。其结果是一种能够提供对抗安全侵犯所必需的保护的安全配置。在虚拟机监视器的案例中，相对于众多服务器软件实例，非安全配置的影响可能更加严重，由于针对虚拟机监视器的攻击可能导致针对其上运行着的众多 VM 的攻击。尽管配置参数的组成取决于虚拟机监视器供应的设计特性，对于每一个独立的参数的值的选择的纬度会产生不同的配置选项。众多配置选项与功能特性和性能相关。然而，有一些选项对于虚拟机监视器的安全执行具有直接影响，并且这些就是此文档中所讨论的配置选项。

以下是一些通用于任何服务器级别的软件的安全实践。尽管也适用于虚拟机监视器，这些并未在此文档中解决：

* (a) 虚拟机监视器宿主本身上的管理帐户控制以及对不同管理员的最小权限指认
* (b) 虚拟机监视器软件和宿主 OS 的补丁管理
* (c) 通过诸如 TLS 或者 Secure Shell（SSH）等安全协议同虚拟机监视器进行通讯

## 7.1 中心化管理

对虚拟机监视器和虚拟机监视器宿主的管理可以通过两种方式实现：

* 在每一个虚拟机监视器宿主中设置有管理帐户
* 通过企业虚拟化管理软件对所有虚拟机监视器和虚拟机监视器宿主进行中心化管理

通过企业虚拟化管理软件（EVMS）对企业中的所有虚拟机监视器平台进行中心化管理是理想的，由于用于企业中的所有虚拟机监视器的一组黄金标准配置可以通过 EVMS 定义并且简单地强制实施。对于任何想要高效运行的 IT 数据中心，实施负载均衡和容错措施是必要的，这可以通过定义虚拟机监视器集群来实现。对集群的创建、指派应用程序负载以及管理只能依靠中心化的管理软件来实现，使得部署和使用企业虚拟化管理软件成为强制性的。

因此，对于虚拟机监视器管理架构的建议如下所述：

_安全性建议 HY-SR-19_：对于企业中安装的所有虚拟机监视器的管理应该利用企业虚拟化管理系统（EVMS）以中心化的方式实现。用于不同类型的负载和集群的企业黄金标准虚拟机监视器配置必须通过 EVMS 进行管理和强制实施。此黄金标准配置至少应该覆盖 CPU、内存、存储、网络带宽，以及如有必要，宿主 OS 加固

## 7.2 保护管理网络

为了将多个 VM 彼此连接起来，以及将它们连接到虚拟化的宿主作为其中一个结点的企业网络，虚拟机监视器通过其管理控制台或者命令行界面（CLI）允许一种由软件定义的通讯结构，或者虚拟网络。此能力可以由专用的管理 VM 提供，也可以直接在虚拟机监视器内核中通过内核模块来提供。虚拟网络是一种由软件定义的人造物，它完全驻留于虚拟化的宿主中，并且拥有驻留于其中的 VM 作为其结点。此虚拟网络的组件包括：(a) 为每一个 VM 定义并且提供每一个 VM 到虚拟网络的连接的虚拟网卡（vNIC）；(b) 在 VM 之间提供选择性的连接性，并且其配置决定了虚拟网络拓扑结构的虚拟交换机；以及 (c) 提供 VM 到企业网络的连接性的虚拟化的宿主的物理网卡（pNIC）。

在考虑虚拟网络的安全性影响时，下列 3 项主要功能必须被考虑到：

* 在属于不同逻辑分组（例如，在基础设施即服务（IaaS）的云服务案例中的不同租用者；诸如网络服务器或者数据库服务器中的不同应用层；或者企业中的不同业务线应用程序等）的 VM 组别中提供选择性的连接性或者隔离
* 设置专用的子网用于关键功能，诸如 (a) 出于安全性或者性能的原因，将 VM 从一个虚拟机监视器宿主迁移到另一个，(b) 连接基于网络的存储设备，以及 (c) 容错性日志
* 在管理 VM（虚拟网络的一个结点）中提供对管理接口的访问，此管理 VM 被用于执行 VM 生命周期管理（HY-BF4）和虚拟机监视器平台管理（HY-BF5）的虚拟机监视器关键基线功能

在上述 3 种功能之中，VM 组别之间的选择性的连接性和隔离对于为运行在这些 VM 上的应用程序提供安全性是必需的，因此超出了此文档的范围。同样的判据适用于设置专用的子网用于基于网络的存储管理。我们已经在第 6 章讨论了 VM 生命周期管理之下的安全 VM 迁移。因此，我们对于虚拟网络配置的专注限于为用于执行 VM 管理和虚拟机监视器管理功能的网络接口提供保护。一种被普遍采用的方式是分配一块专用的物理网卡（NIC）用于处理管理流量，如果这不可行，则改为专用于此功能的虚拟网段（vLAN ID）。

_安全性建议 HY-SR-20_：对于虚拟机监视器宿主和软件管理功能的保护应该通过分配一块专用的物理 NIC 来保证，如果这不可行，则改为将虚拟机监视器的管理接口置于专用的虚拟网段中，并且利用防火墙强制实施流量控制（例如，在企业网络中指定子网，从这些子网到管理接口的流入流量被允许）

