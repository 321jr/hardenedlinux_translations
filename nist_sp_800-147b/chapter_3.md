# 第 3 章 BIOS 安全性原则

NIST SP800-147 所呈现的客户端系统的安全性原则——更新认证、闪存区域完整性和不可绕过性——直接适用于服务器级别的设备。这些安全性原则的本意是化解针对系统 BIOS 的威胁。服务器架构的复杂性以及服务器 BIOS 的多种更新途径要求对 NIST SP800-147 中的指导意见进行延伸。本章列举了主张 BIOS 更新安全性原则对服务器的要求。这些原则在以下的上下文环境中使用“授权”（authorize）和“认证”（authenticate）等词语。对镜像的认证保证它的完整性和来源。它通常植根于固件或者服务器制造商。认证是利用数字签名以密码学的方式实行的。授权是指允许某个更新被系统执行。对更新的授权通常植根于服务器管理员。

## 3.1 BIOS 更新认证

认证 BIOS 更新机制应该在 RTU（参见 2.5 节）中被实施。这些机制使用数字签名来保证 BIOS 更新镜像的合法性和完整性。RTU 的验证组件应该包含数字签名验证算法和一个密钥存储器。此密钥存储器应该包含用于验证 BIOS 更新镜像的签名的公钥，或者该密钥的一种许可的密码学散列值 \[FIPS180-4\]。在后一种情况下，更新机制应该计算由 BIOS 更新镜像提供的公钥的散列值，以保证它与出现在密钥存储器中的某个散列值相匹配，然后才能使用提供的公钥来验证 BIOS 更新镜像的签名。

BIOS 镜像应该以符合 NIST SP800-89，关于获取数字签名应用程序的担保的建议 \[SP800-89\] 的方式被签名，使用一种在 NIST FIPS 186-4，数字签名标准（DSS） \[FIPS186-4\] 中具体说明的许可的数字签名算法，它提供至少 112 位的安全强度，以满足 NIST SP800-131A，过渡：关于密码学算法和密钥长度的使用的过渡的建议 \[SP800-131A\] 的要求。

认证更新机制应该保证在更新 BIOS 之前，BIOS 更新镜像经过数字签名，并且该数字签名可以使用某个已存储的密钥或者由 RTU 来验证。这些机制还可以在执行之前验证闪存存储器中的 BIOS 代码的数字签名，特别是当 BIOS 闪存未被保护时（参见 3.3 节）。恢复机制也应该使用认证更新机制，除非此恢复过程满足安全本地更新的指导意见。

系统应该提供能够防止非授权地将 BIOS 更改至较早的认证版本的机制。这种回滚限制机制可以这样实现，例如通过验证 BIOS 镜像的版本号高于当前安装的 BIOS 镜像版本号。适当的回滚保护方式取决于服务器的使用环境以及运行服务器的组织对安全性和可用性的需求。系统可以允许管理员授权回滚至较早版本、禁用这些机制或者基于他们的需求以其他方式配置这些机制。

## 3.2 安全本地更新

服务器可以可选地包括一种安全本地更新机制，它可以更新系统 BIOS 而无需使用认证更新机制。安全本地更新机制应该通过要求一位管理员物理存在于服务器面前指导更新来授权和认证 BIOS 更新镜像。这种对物理存在的要求化解了远程攻击者主导恶意更新至某个非法系统 BIOS 镜像的风险。

通过远程控制台与服务器进行交互并不满足这种对于物理存在的要求。例如，安全本地更新机制可以被用于从某个不能使用认证更新或者自动恢复机制来更新的损坏的 BIOS 中恢复。安全本地更新机制也可被用于在一台禁止回滚的系统上由物理存在的管理员更改至较早的 BIOS 版本。

然而请注意，实施了安全本地更新机制的系统潜在地容易受到恶意管理员的攻击，或者带有对服务器的物理访问的其他攻击。因此额外的物理、环境以及技术安全措施对于保护这些服务器至关重要，但是它们超出了此文档的范围。

## 3.3 固件完整性保护

如需防止执行非法或者恶意 BIOS 代码，系统 BIOS 应该在 RTU 验证系统 BIOS 和在启动过程中执行 BIOS 之间保持完整性。

为了防止在认证 BIOS 更新过程外对系统 BIOS 进行无意或者恶意的修改，包含 BIOS 的系统闪存存储器（即 BIOS 闪存），除了存储于非易失性存储器中，由系统 BIOS 所使用的配置数据以外，应该被保护起来以防止认证 BIOS 更新机制以外的修改。如果被实施，BIOS 闪存保护应该在执行 RTU 以外的代码之前被启用，并且应该由硬件机制来强制执行，该机制只能通过某种经过授权的机制（例如系统重置）禁用。

如果 BIOS 闪存保护未被实施，那么 BIOS 完整性应该在每一步执行过程之前利用 RTU 的验证组件进行验证以认证此 BIOS 镜像。如果验证失败，则系统应该引发恢复过程，这可以涉及操作人员的介入或者自动进行。引发恢复至某个受保护的合法 BIOS 的自动恢复机制应该被支持。自动恢复机制化解了拒绝服务攻击的风险，在此，攻击者将会加载某个非法 BIOS 并且将系统置于不可启动的状态。此系统可以允许授权的管理员在服务器上配置驱动这些恢复程序的安全策略。

每个 RTU 都应该被保护以防止认证更新机制以外的修改。保证 RTU 完整性的保护机制应该在执行 RTU 以外的代码之前被启用。RTU 完整性保护应该由硬件机制强制执行，该机制只能通过某种授权的机制，例如系统重置来禁用。

## 3.4 不可绕过性

系统及其附带的系统组件和固件的设计应该保证没有任何机制可以安装并执行非法 BIOS 代码，除了通过物理介入以及安全本地更新机制以外。

特别地，认证更新机制应该是在没有贯穿于安全本地更新机制的物理介入的情况下修改 RTU 的唯一机制。系统及其附带的系统组件和固件的设计应该保证没有任何机制可以允许宿主服务器或者任何其他系统组件绕过用于更新 RTU 的认证更新机制，除了安全本地更新机制以外。

现代平台也包含赋予了系统组件对 RTU 或者系统 BIOS 的直接访问的设计特性以改进性能和管理，例如将 BIOS 复制到内存中，或者用于系统管理模式操作。某个系统组件可能会拥有对于系统闪存存储器的读取访问权限，但是它不应该能够直接修改 RTU，除非该组件作为 RTU 的扩展或者就是 RTU 本身。

